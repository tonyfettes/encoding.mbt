package "tonyfettes/encoding"

import(
  "moonbitlang/core/buffer"
)

// Values
const U_REP : Char = 'ï¿½'

fn decode(Bytes, encoding~ : Encoding) -> String!DecodingError

fn decode_lossy(Decoder, Bytes, stream~ : Bool = ..) -> String

fn decode_to(Bytes, StringBuilder, encoding~ : Encoding) -> Unit!

fn encode(String, encoding~ : Encoding) -> Bytes

fn encode_to(String, @buffer.T, encoding~ : Encoding) -> Unit

// Types and methods
type Decoder
impl Decoder {
  decode(Self, Bytes, stream~ : Bool = ..) -> String!DecodingError
  decode_lossy(Self, Bytes, stream~ : Bool = ..) -> String
  decode_lossy_to(Self, Bytes, StringBuilder, stream~ : Bool = ..) -> Unit
  decode_to(Self, Bytes, StringBuilder, stream~ : Bool = ..) -> Unit!DecodingError
}

pub type! DecodingError {
  Malformed(Bytes)
  Truncated(Bytes)
}
impl Show for DecodingError

pub(all) enum Encoding {
  UTF8
  UTF16LE
  UTF16BE
}

// Type aliases

// Traits
pub trait Encode {
  encode(Self, encoding~ : Encoding) -> Bytes
  encode_to(Self, @buffer.T, encoding~ : Encoding) -> Unit
}
impl Encode for Char
impl Encode for String

